# 乐购商城 (LeGou Store) - 原生前端电商平台实战

## 1\. 项目简介

本项目是一个基于 **HTML5、CSS3 和 原生 JavaScript** 开发的 B2C 电商平台前端项目。项目模拟了从用户注册登录、商品浏览、详情展示到购物车结算的完整电商闭环。
**核心亮点**在于不依赖现代前端框架（如 Vue/React），完全使用原生 DOM 操作和 `localStorage` 本地存储技术来实现数据的持久化和交互逻辑，展示了扎实的前端基础能力。

## 2\. 技术栈 (Tech Stack)

  * **结构层 (HTML5)**: 语义化标签布局，构建清晰的页面结构。
  * **表现层 (CSS3)**: 使用 Flexbox 布局、CSS 过渡动画 (Transition)、定位 (Positioning) 等技术还原设计稿。
  * **行为层 (JavaScript ES6+)**:
      * 使用 `fetch` API 请求 JSON 数据实现页面动态渲染。
      * 大量 DOM 操作实现复杂的交互逻辑。
      * `localStorage` 模拟后端数据库，实现用户状态保持和购物车数据持久化。
  * **第三方库**: `Swiper.js` (用于首页轮播图)。

## 3\. 项目目录结构

```text
LeGou-Store/
├── css/                # 样式文件 (包含 reset.css 重置样式及各页面独立样式)
├── js/                 # 逻辑脚本 (包含 header-footer.js 公共逻辑及各页面独立脚本)
├── imgs/               # 图片资源 (包含商品图、UI图标、Banner等)
├── data/               # 模拟数据 (JSON格式，用于首页内容渲染)
├── lib/                # 第三方依赖 (Swiper)
├── index.html          # 首页
├── login.html          # 登录页
├── register.html       # 注册页
├── detail.html         # 商品详情页
└── shoppingCar.html    # 购物车页
```

## 4\. 核心功能模块

### 4.1 全局公共模块 (`js/header-footer.js`)

  * **状态管理**：通过读取 `localStorage` 中的 `lego-current-user` 判断用户登录状态。
  * **UI 响应**：登录后自动隐藏“登录/注册”入口，显示“用户名/退出”入口。
  * **注销逻辑**：点击退出清除本地会话数据并刷新页面。

### 4.2 首页模块 (`index.html` / `js/index.js`)

  * **动态渲染**：使用 `fetch` 异步加载 `nav.json` 和 `index.json`，动态生成导航栏、侧边栏菜单及楼层商品内容，模拟前后端分离的数据交互。
  * **交互特效**：
      * **轮播图**：集成 Swiper 插件实现焦点图轮播。
      * **吸顶搜索框**：监听 `scroll` 事件，页面滚动超过阈值时，顶部搜索栏自动滑出。
      * **楼层跳转 (电梯导航)**：侧边栏监听点击事件，平滑跳转至对应商品楼层（图书、服装、运动等）。
      * **回到顶部**：使用反比例函数算法实现由快到慢的平滑滚动动画。
      * **手风琴效果**：新书畅销榜区域实现鼠标悬停展开/收起的交互。

### 4.3 用户认证模块

  * **注册 (`register.js`)**：
      * **表单验证**：正则校验手机号、密码长度及用户名格式。
      * **验证码生成**：原生 JS 生成带有随机旋转、颜色和干扰线的图形验证码。
      * **数据存储**：注册成功后将用户信息存入 `localStorage` 的 `lego-users` 数组中，并进行用户名查重。
  * **登录 (`login.js`)**：
      * **多方式切换**：支持“扫码登录”与“账户登录”的 Tab 切换。
      * **身份校验**：遍历本地存储的用户列表进行匹配，登录成功后写入会话状态。

### 4.4 商品详情模块 (`detail.js`)

  * **放大镜/相册切换**：点击缩略图切换主图，支持左右按钮切换图片序列。
  * **规格交互**：商品种类（如平装/精装）的排他性选择逻辑。
  * **加入购物车**：获取当前页面的商品信息（图片、标题、价格、数量），封装为对象存入 `localStorage` 的 `lego-shoppingItems`，支持追加数量而非简单覆盖。
  * **模拟分页**：底部评论区实现了完整的分裂式分页逻辑（首页、末页、省略号处理）。

### 4.5 购物车模块 (`shoppingCar.js`)

  * **核心算法**：
      * **数据加载**：从本地存储读取商品列表并动态生成 HTML 结构。
      * **联动计算**：单品数量变更 $\rightarrow$ 小计变更 $\rightarrow$ 总价/总数量变更。
      * **全选/反选**：全选按钮控制所有子项，任意子项取消则取消全选状态。
  * **数据同步**：
      * 删除商品时同步移除 DOM 节点和 `localStorage` 中的对应数据。
      * “猜你喜欢”点击商品可直接加入购物车并即时刷新列表。

## 5\. 技术难点与解决方案

1.  **数据持久化与跨页面通信**：

      * *问题*：如何在不使用后端数据库的情况下，让详情页添加的商品在购物车页显示？
      * *解决*：利用 `localStorage` 作为临时数据库。在写入时先读取现有数组，push 新数据后再序列化 (`JSON.stringify`) 存入；读取时反序列化 (`JSON.parse`) 进行渲染。

2.  **购物车的级联更新逻辑**：

      * *问题*：修改数量、删除商品、勾选商品都会影响总价，逻辑容易混乱。
      * *解决*：采用了“事件委托”和“重新初始化”的策略。封装了 `updateTotal()`（计算总价）、`updateSubtotal()`（计算小计）等函数。每当发生增删改操作时，重新调用计算函数，确保数据一致性。

3.  **原生 JS 实现复杂分页逻辑**：

      * *问题*：详情页底部的页码需要处理首页、尾页、当前页前后及省略号的显示逻辑。
      * *解决*：编写了 `btnsControl` 函数，通过判断当前激活页码（active index），动态控制“...”省略号和页码数字的显示与隐藏，实现了类似于分裂式分页的算法。

## 6\. 项目运行与预览

1.  确保本地已安装浏览器（推荐 Chrome）。
2.  无需配置服务器环境，直接双击 `index.html` 即可运行（由于包含 `fetch` 请求，建议使用 VSCode 的 **Live Server** 插件运行以避免跨域策略限制）。
3.  **测试账号**：您可以先在注册页注册新账号，或直接查看代码逻辑。

## 7\. 未来优化方向

  * **响应式适配**：目前主要适配 PC 端 (1200px 宽度)，未来可增加媒体查询适配移动端。
  * **组件化重构**：引入 Vue.js 或 React 将头部、底部、商品卡片封装为组件，提高代码复用率。
  * **后端对接**：搭建 Node.js 服务器，替换 `localStorage` 为真实的 API 接口与数据库交互。
